<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Embedded API Demo 2 &mdash; Method Draw</title>
    <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
</head>
<body>

<div class="container" style="margin-top: 50px;">

    <p>
        <button v-on:click="show" class="btn btn-default">Edit</button>
    </p>
    <div class="row">
        <div class="col-md-6">
            <div class="thumbnail">
                <img src="data:image/svg+xml;charset=utf-8,{{ svg }}">
            </div>
        </div>
        <div class="col-md-6">
            <pre>{{ svg }}</pre>
        </div>
    </div>

</div>

<div id="modal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header hidden">
                <button v-on:click="cancel" type="button" class="" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Modal title</h4>
            </div>
            <div class="modal-body">
                <iframe id="iframe" src="../index.html" width="100%" height="400" style="border: none;"></iframe>
            </div>
            <div class="modal-footer">
                <button v-on:click="cancel" type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button v-on:click="insert" type="button" class="btn btn-primary">Insert</button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/vue/1.0.14/vue.min.js"></script>
<script type="text/javascript" src="../src/embedapi.js"></script>
<script type="text/javascript">

    var svgCanvas;

    jQuery(function () {
        svgCanvas = new embedded_svg_edit($('#iframe').get(0));
    });

    new Vue({
        el: 'body',
        data: {
            svg: "<svg width=\"580\" height=\"400\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\">\n <!-- Created with Method Draw - http:\/\/github.com\/duopixel\/Method-Draw\/ -->\n\n <g>\n  <title>background<\/title>\n  <rect x=\"-1\" y=\"-1\" width=\"582\" height=\"402\" id=\"canvas_background\" fill=\"#fff\"\/>\n  <g id=\"canvasGrid\" display=\"none\">\n   <rect id=\"svg_5\" width=\"100%\" height=\"100%\" x=\"0\" y=\"0\" stroke-width=\"0\" fill=\"url(#gridpattern)\"\/>\n  <\/g>\n <\/g>\n <g>\n  <title>Layer 1<\/title>\n  <rect fill=\"#D1FFB4\" stroke=\"#000\" stroke-width=\"1.5\" x=\"58.5\" y=\"82\" width=\"125\" height=\"71\" id=\"svg_1\"\/>\n  <ellipse fill=\"#D1FFB4\" stroke-width=\"1.5\" cx=\"259\" cy=\"118\" id=\"svg_2\" rx=\"60.5\" ry=\"39\" stroke=\"#000\"\/>\n  <ellipse fill=\"#D1FFB4\" stroke-width=\"1.5\" cx=\"120\" cy=\"204\" id=\"svg_3\" rx=\"62.5\" ry=\"43\" stroke=\"#000\"\/>\n  <path fill=\"#D1FFB4\" stroke=\"#000\" stroke-width=\"1.5\" stroke-opacity=\"null\" fill-opacity=\"null\" d=\"m328.17749,183.74866c0,5.79858 -28.43002,10.49994 -63.49994,10.49994m63.49994,-10.49994l0,0c0,5.79858 -28.43002,10.49994 -63.49994,10.49994c-35.06918,0 -63.50006,-4.70135 -63.50006,-10.49994m0,0l0,0c0,-5.79892 28.43088,-10.50032 63.50006,-10.50032c35.06992,0 63.49994,4.7014 63.49994,10.50032l0,41.99942c0,5.7991 -28.43002,10.50024 -63.49994,10.50024c-35.06918,0 -63.50006,-4.70114 -63.50006,-10.50024l0,-41.99942z\" id=\"svg_4\"\/>\n <\/g>\n<\/svg>"
        },
        methods: {
            show: function () {
                svgCanvas.setSvgString(this.svg);
                $('#modal').modal();
            },
            insert: function () {
                var _this = this;
                svgCanvas.getSvgString({removeBackground: true})(function (data, error) {
                    if (error) {
                        alert('error: ' + error);
                    }
                    else {
                        _this.svg = data;
                    }
                    $('#modal').modal('hide');
                });
            },
            cancel: function () {
                $('#modal').modal('hide');
            }
        }
    });

</script>

</body>
</html>
